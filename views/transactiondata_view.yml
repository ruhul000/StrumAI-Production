version: 1
type: view
name: transactions
description: >-
  The monthly snapshot table with transaction information. To look at this data
  accurately, you must ALWAYS filter for a specific month using the
  data_period_date using the last day of the month. Ask the user to specify the
  period, if they did not initially
model_name: strum_platform_model
sql_table_name: dbo.TransactionData
default_date: data_period
identifiers:
- name: acctid
  type: primary
  sql: concat(${acctid}, ${data_period_raw})
- name: custid
  type: foreign
  sql: concat(${custid}, ${data_period_raw})
fields:
- name: custid
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custid
  searchable: false

- name: acctid
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.acctid
  searchable: false

- name: hhid
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.hhid
  searchable: false

- name: voidcode
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.voidcode
  searchable: false

- name: branchid
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.branchid
  searchable: true

- name: lifestyleid
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.lifestyleid
  searchable: false

- name: gencodeid
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.gencodeid
  searchable: false

- name: prim_key
  field_type: dimension
  type: string
  hidden: true
  primary_key: true
  sql: concat(${acctid}, ${custid})

- name: reg_d_checkcode
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.reg_d_checkcode
  searchable: false

- name: actioncode
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.actioncode
  searchable: true

- name: actioncodedesc
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.actioncodedesc
  searchable: true

- name: subactioncode
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.subactioncode
  searchable: true

- name: subactioncodedesc
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.subactioncodedesc
  searchable: true

- name: sourcecode
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.sourcecode
  searchable: true

- name: source_code_description
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: The source (e.g. credit card or debit card) of the transaction
  sql: ${TABLE}.SourceCodeDesc
  searchable: true

- name: subsourcecode
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.subsourcecode
  searchable: false

- name: subsourcecodedesc
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.subsourcecodedesc
  searchable: true

- name: transaction_code
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.TransactionCode
  searchable: true

- name: transaction_code_description
  field_type: dimension
  type: string
  description: The description of the transaction itself
  sql: ${TABLE}.TransactionCodeDescription
  searchable: true

- name: transaction_channel
  field_type: dimension
  type: string
  sql: ${TABLE}.Channel
  searchable: true

- name: transactionnumber
  field_type: dimension
  type: number
  hidden: false
  primary_key: false
  label: Transaction Number
  description: ''
  sql: ${TABLE}.transactionnumber
  searchable: false

- name: tellernumber
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.tellernumber
  searchable: false

- name: jh_description
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.jh_description
  searchable: false

- name: branchname
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.branchname
  searchable: true

- name: recurring
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.recurring
  searchable: false

- name: waivedlatechargeamt
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.waivedlatechargeamt
  searchable: false

- name: transaction_amount
  field_type: dimension
  type: number
  sql: ${TABLE}.TransactionAmount

- name: transfercode
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.transfercode
  searchable: false

- name: transactiondescription
  field_type: dimension
  type: string
  hidden: false
  primary_key: false
  label: Transaction Description
  description: ''
  sql: ${TABLE}.transactiondescription
  searchable: false

- name: transactiondescription2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.transactiondescription2
  searchable: false

- name: lifestylename
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.lifestylename
  searchable: true

- name: gencodesname
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.gencodesname
  searchable: true

- name: agetier
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.agetier
  searchable: true

- name: agetierdescription
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.agetierdescription
  searchable: true

- name: activity_date
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  description: ''
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.ActivityDate

- name: postdate
  field_type: dimension_group
  type: time
  datatype: date
  hidden: false
  label: PostDate
  description: ''
  timeframes:
  - raw
  - date
  - month
  - year
  sql: ${TABLE}.postdate

- name: activitytime
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.ActivityTime

- name: activitytimeband
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.ActivityTimeBand

- name: effectivedate
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.EffectiveDate

- name: data_period
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  description: >-
    This is the period of the snapshot, and it is always the date of the end
    of the month
  timeframes:
  - raw
  - date
  sql: ${TABLE}.DataPeriod
  synonyms:
  - transaction

- name: asofdataperiod
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.AsOfDataPeriod

- name: processeddate
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.ProcessedDate

- name: number_of_members
  field_type: measure
  type: count_distinct
  hidden: true
  sql: ${custid}

- name: number_of_accounts
  field_type: measure
  type: count_distinct
  hidden: true
  sql: ${acctid}

- name: avg_transaction_amount
  field_type: measure
  type: average
  description: The average value of transactions in USD
  value_format_name: usd
  sql: ${transaction_amount}

- name: number_of_transactions
  field_type: measure
  type: count
  description: The total number of transactions
  value_format_name: decimal_0
  sql: concat(${acctid}, ${custid})

- name: transactions_per_member
  field_type: measure
  type: number
  hidden: true
  description: >-
    The total number of transactions / the number of members making those
    transactions
  value_format_name: decimal_0
  sql: ${number_of_transactions} / ${number_of_members}

- name: total_transaction_amount
  field_type: measure
  type: sum
  description: The total value of transactions in USD
  value_format_name: usd
  sql: ${transaction_amount}

- name: total_transaction_amount_per_member
  field_type: measure
  type: number
  hidden: true
  description: >-
    The total transaction amount / the number of members making those
    transactions
  value_format_name: usd
  sql: ${total_transaction_amount} / ${number_of_members}
