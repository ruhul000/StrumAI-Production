version: 1
type: view
name: accounts
description: >-
  The monthly snapshot table with account information. To look at this data
  accurately, you must ALWAYS filter for a specific month using the
  data_period_date using the last day of the month. Ask the user to specify the
  period, if they did not initially
model_name: strum_platform_model
sql_table_name: dbo.Accounts
default_date: data_period
identifiers:
- name: acctid
  type: primary
  sql: concat(${acctid}, ${data_period_raw})
- name: custid
  type: foreign
  sql: concat(${custid}, ${data_period_raw})
- name: productid
  type: foreign
  sql: ${productid}
- name: household
  type: foreign
  sql: concat(${hhid}, ${data_period_raw})
- name: officer_id
  type: foreign
  sql: concat(${officer},${data_period_raw})
- name: branchid
  type: foreign
  sql: concat(${branchid}, ${data_period_raw})
fields:
- name: acctid
  field_type: dimension
  type: string
  hidden: false
  primary_key: true
  label: Account ID
  description: ''
  sql: ${TABLE}.acctid
  searchable: false
  synonyms:
  - Unique Account

- name: hhid
  field_type: dimension
  type: number
  hidden: true
  sql: ${TABLE}.hhid
  synonyms:
  - Household

- name: custid
  field_type: dimension
  type: string
  primary_key: false
  description: >-
    Unique ID generated by the system (based on TIN) for each customer that
    owns one or more accounts.
  sql: ${TABLE}.custid
  searchable: false
  synonyms:
  - individual, member, customer

- name: productid
  field_type: dimension
  type: number
  hidden: true
  sql: ${TABLE}.productid
  synonyms:
  - Product, Product Type, Account type

- name: bkhhid
  field_type: dimension
  type: string
  hidden: true
  description: >-
    institution specific code to identify customer relationship between one or
    more accounts.
  sql: ${TABLE}.bkhhid
  searchable: true

- name: branchid
  field_type: dimension
  type: number
  hidden: true
  description: >-
    Id of the branch to which this account is assigned (-1 means un-assigned)
    (zero is valid branch number). For lost accounts, must reflect branchId in
    current branch table.
  sql: ${TABLE}.branchid
  synonyms:
  - Account branch, Deposit branch, loan branch, product branch

- name: obranchid
  field_type: dimension
  type: number
  hidden: true
  sql: ${TABLE}.obranchid
  synonyms:
  - Original Branch

- name: mktid
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Id of the Primary Lived-In Market Area. -1 => falls outside overall market
    area; 0 => not in any market area but w/in overall; or valid market id.
  sql: ${TABLE}.mktid
  searchable: false

- name: tractid
  field_type: dimension
  type: string
  hidden: true
  sql: ${TABLE}.tractid
  searchable: false

- name: resfooid
  field_type: dimension
  type: number
  hidden: true
  sql: ${TABLE}.resfooid

- name: busfooid
  field_type: dimension
  type: number
  hidden: true
  sql: ${TABLE}.busfooid

- name: acctnum
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Account number assigned by the institution
  sql: ${TABLE}.acctnum
  searchable: true

- name: account_type
  field_type: dimension
  type: string
  description: Type of the account
  sql: >-
    case when ${TABLE}.typeacct = 1 then 'Retail' when ${TABLE}.typeacct = 2
    then 'Commercial' else 'Unknown' end
  searchable: true
  synonyms:
  - retail
  - commerical

- name: household_type
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Type of household owning the account.
  sql: >-
    case when ${TABLE}.typehh = 1 then 'Retail' when ${TABLE}.typehh = 2 then
    'Commercial' when ${TABLE}.typehh = 3 then 'Mixed' else 'Unknown' end
  searchable: true

- name: status
  field_type: dimension
  type: number
  hidden: false
  primary_key: false
  label: Account Status
  description: ''
  sql: ${TABLE}.status
  searchable: false

- name: acct_stage
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: The stage of the account.
  sql: ${TABLE}.acctstage
  searchable: true
  synonyms:
  - Account Status

- name: cifcode
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Institution specific code to identify unique customer.
  sql: ${TABLE}.cifcode
  searchable: false

- name: officer
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Code denoting bank officer responsible for the account relationship
    (0=unavailable).
  sql: ${TABLE}.officer
  searchable: true

- name: gender
  field_type: dimension
  type: string
  hidden: false
  primary_key: false
  label: AC Gender
  description: Gender code of account primary name
  sql: ${TABLE}.gender
  searchable: true

- name: gender_secondary
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Gender (M/F) of account secondary name
  sql: ${TABLE}.gender2
  searchable: true

- name: name1
  field_type: dimension
  type: string
  primary_key: false
  description: Full name of primary account holder.
  sql: ${TABLE}.name1
  searchable: false

- name: name_secondary
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Full name of secondary or joint account holder.
  sql: ${TABLE}.name2
  searchable: false

- name: name1out
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.name1out
  searchable: false

- name: name2out
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.name2out
  searchable: false

- name: name1type
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.name1type
  searchable: false

- name: name2type
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.name2type
  searchable: false

- name: lastname1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.lastname1
  searchable: false

- name: lastname2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.lastname2
  searchable: false

- name: first1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.first1
  searchable: false

- name: first2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.first2
  searchable: false

- name: tin1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.tin1
  searchable: false

- name: tin2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.tin2
  searchable: false

- name: busowner
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.busowner
  searchable: true

- name: ownerlname
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.ownerlname
  searchable: true

- name: sic
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.sic
  searchable: true

- name: phone1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.phone1
  searchable: true

- name: phone2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.phone2
  searchable: false

- name: cellphone
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.cellphone
  searchable: true

- name: email
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.email
  searchable: false

- name: email2
  field_type: dimension
  type: string
  hidden: true
  sql: ${TABLE}.email2
  searchable: true

- name: email3
  field_type: dimension
  type: string
  hidden: true
  sql: ${TABLE}.email3
  searchable: true

- name: address1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Primary address line associated with an account's address
  sql: ${TABLE}.address1
  searchable: true

- name: address2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.address2
  searchable: false

- name: city
  field_type: dimension
  type: string
  hidden: false
  primary_key: false
  label: AC City
  description: ''
  sql: ${TABLE}.city
  searchable: false

- name: state
  field_type: dimension
  type: string
  hidden: false
  primary_key: false
  label: AC State
  description: State that accountholder resides in
  sql: ${TABLE}.state
  searchable: true

- name: zip
  field_type: dimension
  type: string
  hidden: false
  primary_key: false
  label: AC Zip
  description: ''
  sql: ${TABLE}.zip
  searchable: false

- name: zip4
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.zip4
  searchable: false

- name: acctdist
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.acctdist
  searchable: false

- name: blockgrp
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.blockgrp
  searchable: true

- name: crrt
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.crrt
  searchable: true

- name: lmi
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: Denotes tract income level. (1=low;2=moderate;3=middle;4=upper;9=unknown).
  sql: ${TABLE}.lmi
  searchable: true

- name: stfips
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.stfips
  searchable: true

- name: ctfips
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: County FIPS Code
  sql: ${TABLE}.ctfips
  searchable: false

- name: latitude
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.latitude
  searchable: false

- name: longitude
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.longitude
  searchable: false

- name: custsvcflg
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: >-
    Companion services (up to 20). Each byte is a flag that may be defined to
    denote a specific companion service. The first five services are
    pre-defined and cannot be changed by the user. The Ordinal position of the
    flag is the key to CUSTSERV table (compid field).
  sql: ${TABLE}.custsvcflg
  searchable: false

- name: sof
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: >-
    bank provided code indicating the source of a customers funds when opening
    a new account.
  sql: ${TABLE}.sof
  searchable: true

- name: rcci
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.rcci
  searchable: true

- name: aom
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.aom
  searchable: true

- name: odp
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.odp
  searchable: true

- name: seg
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.seg
  searchable: true

- name: nomail
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Flag denoting that the owner of this account does not want to be solicited
    via US mail.
  sql: ${TABLE}.nomail
  searchable: false

- name: nocall
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Flag denoting that the owner of this account does not want to be solicited
    via phone
  sql: ${TABLE}.nocall
  searchable: false

- name: noemail
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Flag denoting that the owner of this account does not want to be solicited
    via email
  sql: ${TABLE}.noemail
  searchable: false

- name: noshare
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Flag denoting that the owner of this account does not want their
    information to be shared with non-affiliated 3rd parties
  sql: ${TABLE}.noshare
  searchable: false

- name: noshareall
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: >-
    Flag denoting that the owner of this account does not want their
    information to be shared with any 3rd parties.
  sql: ${TABLE}.noshareall
  searchable: false

- name: custcode1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custcode1
  searchable: true

- name: custcode2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custcode2
  searchable: true

- name: custnum1
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custnum1
  searchable: false

- name: custnum2
  field_type: dimension
  type: number
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custnum2
  searchable: false

- name: custtext1
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custtext1
  searchable: true

- name: custtext2
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custtext2
  searchable: true

- name: matchkey
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.matchkey
  searchable: true

- name: sys_source
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: Application system from which data is extracted.
  sql: ${TABLE}.sys_source
  searchable: true

- name: custtext3
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custtext3
  searchable: true

- name: custsvcflglist
  field_type: dimension
  type: string
  hidden: true
  primary_key: false
  description: ''
  sql: ${TABLE}.custsvcflglist
  searchable: true

- name: islost
  field_type: dimension
  type: yesno
  hidden: false
  primary_key: false
  label: AC IsLost
  description: ''
  sql: ${TABLE}.islost
  searchable: false

- name: pahdob
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.pahdob

- name: sahdob
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.sahdob

- name: custdate1
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.custdate1

- name: custdate2
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.custdate2

- name: membjoindt
  field_type: dimension_group
  type: time
  datatype: datetime
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.membjoindt

- name: data_period
  field_type: dimension_group
  type: time
  datatype: date
  description: >-
    This is the period of the snapshot, and it is always the date of the end
    of the month
  timeframes:
  - raw
  - date
  - month
  sql: ${TABLE}.DataPeriod
  synonyms:
  - account

- name: created_on
  field_type: dimension_group
  type: time
  datatype: date
  hidden: false
  label: AC Created On
  description: ''
  timeframes:
  - raw
  - date
  - day_of_year
  - month
  - month_of_year
  - year
  sql: ${TABLE}.CreatedOn

- name: updatedon
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - month
  - month_of_year
  - year
  sql: ${TABLE}.UpdatedOn

- name: filedate
  field_type: dimension_group
  type: time
  datatype: date
  hidden: true
  timeframes:
  - raw
  - date
  - day_of_year
  - month
  - month_of_year
  - year
  sql: ${TABLE}.FileDate

- name: distinct_products
  field_type: measure
  type: count_distinct
  description: Number of distinct products
  sql: ${productid}

- name: total_accounts
  field_type: measure
  type: count_distinct
  label: Total Accounts
  description: Total number of accounts
  value_format_name: decimal_0
  sql: case when ${islost}=0 then ${acctid} end
  canon_date: accounts.data_period
